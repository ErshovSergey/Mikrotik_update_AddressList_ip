### По мотивам моего поста https://geektimes.ru/post/270242/

# Smart TV — может и не следит. Но всё-таки…

Производители бытовой техники, например *SmartTV*, добавляют много удобств в свою продукцию. 
Взамен они собирают информацию о пользователях, что смотрит, когда, из каких источников и т.п.
Эту информацию используют для показа релевантной рекламы и вероятно в других целях.
Могут поделится информацией с другими компаниями.
Всё это законно согласно очередному лицензионному соглашению которое не принять невозможно.

Скрипт установленный на маршрутизатор [Mikrotik](https://mikrotik.com/) (необходима версия [RouterOS](https://www.mikrotik.com/software) 6.36 или новее) позволяет исказить эту информацию путем блокирования пакетов от телевизора на соответствующие домены.

Список *"запрещенных"* доменов задается в теле скрипта.
Список был собран по крупицам из интернета и дополнен путем наблюдения за своим SmartTV.

#### Домен в списке можно задать:
- "строго", например **youtube.com** - в это случае будет блокироваться только домен **youtube.com**, а **www.youtube.com** - будет доступен.
- "с префиксом", например ***.youtube.com** - в этом случае будут блокироваться все домены совпадающие с маской ***.youtube.com**, в т.ч. и **youtube.com**

#### Как работает скрипт:
- просматривает *dns cache* маршрутизатора и анализирует на предмет совпадения со списком "запрещенных" доменов
- при совпадении добавляет в *Address Lists* соответствующий домен, при добавлении доменов "с префиксом" также добавляется TTL.

В *IP/Firewall* надо добавить правило, которое блокирует доступ для *SmartTV* до доменов из списка (задается в скрипте, параметр NameAddressList) вида 
    `chain=forward action=reject reject-with=icmp-network-unreachable src-address=192.168.100.123 dst-address-list=BlockSpySmartTV log=no log-prefix="BlockSpySmartTV:" `,
где 192.168.100.123 - ip адрес телевизора.

#### Обеспечить периодичность запуска скрипта.
Добавьте в расписание задачу по запуску скрипта с нужной периодичностью.

Создаваемая на маршрутизатор нагрузка от фильтрации - на уровне погрешности - увеличения не заметил.
Нагрузка при работе скрипта заметна, стоит подобрать периодичность запуска скрипта. У меня одна минута.

Также стоит рассмотреть возможность выключить обновления ПО SmartTV.
